package com.neo.byez.dao.item;

import static org.junit.Assert.*;

import com.neo.byez.dao.user.UserDaoImpl;
import com.neo.byez.domain.item.BasketDto;
import com.neo.byez.domain.item.BasketItemDto;
import com.neo.byez.domain.item.ItemDto;
import com.neo.byez.domain.user.UserDto;
import java.util.List;

import com.neo.byez.domain.user.UserDto;
import org.junit.Before;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.extension.ExtendWith;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.ValueSource;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit.jupiter.SpringExtension;

import static org.junit.Assert.assertNotNull;


// ê²°ê³¼ : [âœ…]í…ŒìŠ¤íŠ¸ ì™„ë£Œ(24/24)
@ContextConfiguration(locations = {"file:src/main/webapp/WEB-INF/spring/root-context.xml"})
@ExtendWith(SpringExtension.class)
public class BasketItemDaoImplTest {

    @Autowired
    private BasketDaoImpl basketDao;

    @Autowired
    private BasketItemDaoImpl basketItemDao;

    @Autowired
    private UserDaoImpl userDao;

    @Autowired
    private ItemDaoImpl itemDao;


    // 0. [âœ…]ì´ˆê¸° í…ŒìŠ¤íŠ¸
    @Before
    public void ì£¼ì…_ìƒíƒœ_í™•ì¸() {
        assertNotNull(userDao);
        assertNotNull(itemDao);
        assertNotNull(basketItemDao);
        assertNotNull(basketDao);
    }

    @BeforeEach
    public void ì´ˆê¸°í™”() throws Exception {
        // í…Œì´ë¸” ë¹„ìš°ê¸°
        // ì¥ë°”êµ¬ë‹ˆ ì‚¬í’ˆ ì§€ìš°ê¸°
        List<UserDto> users = userDao.selectUserAll();
        for (UserDto user : users) {
            BasketItemDto dto = new BasketItemDto();
            dto.setId(user.getId());
            basketItemDao.deleteAll(dto);
        }

        // ì¥ë°”êµ¬ë‹ˆ ì§€ìš°ê¸°
        basketDao.deleteAll();

        // ìƒí’ˆ ì§€ìš°ê¸°
        itemDao.deleteAll();

        // ìœ ì € ì§€ìš°ê¸°
        userDao.deleteAllUser();

    }



//
//    // 1. í•µì‹¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ 2ì°¨ êµ¬í˜„[âœ…] ğŸ“ ë°‘ì— ë¬¸ì„œ ì¶”í›„ì— ìˆ˜ì •í•˜ê¸°
//    // 1-0. ì¹´ìš´íŠ¸ : ìœ ì € ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ê°œìˆ˜ ì¹´ìš´íŠ¸ -> ì„±ê³µ(ì–‘ ë§ì´), ì‹¤íŒ¨(ì ìš© ë¡œìš°ìˆ˜ 0)
//        // ì¹´ìš´íŠ¸_ì„±ê³µ() => íŠ¹ì • ìœ ì € ì•„ì´ë””ë¡œ ìƒí’ˆ ì—¬ëŸ¬ê°œ ë‹´ì•„ì„œ ì¹´ìš´íŠ¸
//        // ì¹´ìš´íŠ¸_ì‹¤íŒ¨() => ì—†ëŠ” ìœ ì € ì•„ì´ë””ë¡œ ì¹´ìš´íŠ¸ í–ˆì„ ë•Œ, ì ìš© ë¡œìš°ìˆ˜ 0
//
//    // 1-1. ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ : ìœ ì € ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ëª©ë¡ ì¡°íšŒ -> ì„±ê³µ(ì–‘ ë§ì´), ì‹¤íŒ¨(ë¦¬ìŠ¤íŠ¸ ê¸¸ì´ 0), ì˜ˆì™¸ ë°œìƒ
//        // ë¦¬ìŠ¤íŠ¸_ì¡°íšŒ_ì„±ê³µ() => íŠ¹ì • ìœ ì € ì•„ì´ë””ë¡œ ìƒí’ˆ ëª©ë¡ ì¡°íšŒ, ê¸¸ì´ ë„£ì€ ìˆ˜ ë§Œí¼
//        // ë¼ìŠ¤íŠ¸_ì¡°íšŒ_ì‹¤íŒ¨() => ì—†ëŠ” ìœ ì € ì•„ì´ë””ë¡œ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ, ê¸¸ì´ 0
//
//    // 1-2. ë“±ë¡ : ìœ ì € ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ë“±ë¡ -> ì„±ê³µ(ì–‘ ë§ì´), ì‹¤íŒ¨(ì ìš© ë¡œìš°ìˆ˜ 0), ì˜ˆì™¸ ë°œìƒ
//        // ë“±ë¡_ì„±ê³µ() => íŠ¹ì • ìœ ì € ì•„ì´ë””ì— ë§ì€ ì–‘ì˜ ìƒí’ˆ ë“±ë¡
//        // ë“±ë¡_ì‹¤íŒ¨_1() => ì—†ëŠ” ìœ ì € ì•„ì´ë””ë¡œ ìƒí’ˆ ë“±ë¡, ì ìš© ë¡œìš°ìˆ˜, ì˜ˆì™¸ ë°œìƒ
//        // ë“±ë¡_ì‹¤íŒ¨_2() => ì•„ì´ë””ê°€ nullë¡œ ìƒí’ˆ ë“±ë¡, ì ìš© ë¡œìš°ìˆ˜, ì˜ˆì™¸ ë°œìƒ
//
//    // 1-3. ë‹¨ê±´ ì‚­ì œ : ìœ ì € ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ì‚­ì œ1(ì‹œí€€ìŠ¤ & ì•„ì´ë””) -> ì„±ê³µ(ì–‘ ë§ì´), ì‹¤íŒ¨(ì ìš© ë¡œìš°ìˆ˜ 0), ì˜ˆì™¸ ë°œìƒ
//        // ë‹¨ê±´_ì‚­ì œ_ì„±ê³µ_1() => ìœ ì € ì•„ì´ë””ì— ë“±ë¡ëœ íŠ¹ì • ìƒí’ˆ ì‚­ì œ
//        // ë‹¨ê±´_ì‚­ì œ_ì‹¤íŒ¨_1_1() => ìœ ì € ì•„ì´ë””ì— ë“±ë¡ë˜ì§€ ì•Šì€ ìƒí’ˆ ì‚­ì œ(ì‹œí€€ìŠ¤ x)
//        // ë‹¨ê±´_ì‚­ì œ_ì‹¤íŒ¨_1_2() => ë“±ë¡ë˜ì§€ ì•Šì€ ìœ ì € ì•„ì´ë””ì— ìƒí’ˆ ì‚­ì œ, ì ìš© ë¡œìš°ìˆ˜ 0
//        // ë‹¨ê±´_ì‚­ì œ_ì‹¤íŒ¨_1_3() => ìœ ì € ì•„ì´ë””ì— ì‚­ì œëœ ë‚´ìš©ì„ ì—¬ëŸ¬ë²ˆ ì‚­ì œ, ì²«ë²ˆì§¸ì—ì„œëŠ” ì ìš© ë¡œìš°ìˆ˜ 1, ê·¸ ì´í›„ì—ëŠ” 0
//
//        // ë‹¨ê±´_ì‚­ì œ_ì„±ê³µ_2() => ë“±ë¡ëœ dtoë¡œ ì‚­ì œí•˜ëŠ” ê²½ìš°, ì ìš© ë¡œìš°ìˆ˜ 1
//        // ë‹¨ê±´_ì‚­ì œ_ì‹¤íŒ¨_2_1() => ë“±ë¡ë˜ì§€ ì•ŠëŠ” dtoë¡œ ì‚­ì œí•˜ëŠ” ê²½ìš°, ì ìš© ë¡œìš°ìˆ˜ 0
//        // ë‹¨ê±´_ì‚­ì œ_ì‹¤íŒ¨_2_2() => ë“±ë¡ë˜ì§€ ì•Šì€ ìœ ì € ì•„ì´ë””ì— dtoë¡œ ìƒí’ˆ ì‚­ì œ, ì ìš© ë¡œìš°ìˆ˜ 0
//        // ë‹¨ê±´_ì‚­ì œ_ì‹¤íŒ¨_2_3() => ìœ ì € ì•„ì´ë””ì— ì‚­ì œëœ ìƒí’ˆì„ ì—¬ëŸ¬ë²ˆ ì‚­ì œ, ì²«ë²ˆì§¸ì—ì„œëŠ” ì ìš© ë¡œìš°ìˆ˜ 1, ê·¸ ì´í›„ì—ëŠ” 0
//
//    // 1-4. ëª¨ë“  ìƒí’ˆ ì‚­ì œ : ìœ ì € ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ëª¨ë‘ ì‚­ì œ -> ì„±ê³µ(ì–‘ ë§ì´), ì‹¤íŒ¨(ì ìš© ë¡œìš°ìˆ˜ 0), ì˜ˆì™¸ ë°œìƒ
//        // ëª¨ë“ _ìƒí’ˆ_ì‚­ì œ_ì„±ê³µ() => ìœ ì € ì•„ì´ë””ì— ë“±ë¡ëœ ìƒí’ˆ ëª¨ë‘ ì‚­ì œ, ì ìš© ë¡œìš°ìˆ˜ n, ì¹´ìš´íŠ¸ 0
//        // ëª¨ë“ _ìƒí’ˆ_ì‚­ì œ_ì‹¤íŒ¨() => ìœ ì € ì•„ì´ë””ì— ë“±ë¡ë˜ì§€ ì•Šì€ ìƒí’ˆ ëª¨ë‘ ì‚­ì œ, ì ìš© ë¡œìš°ìˆ˜ 0
//
//    // 1-5. ìˆ˜ì • : ìœ ì € ì¥ë°”êµ¬êµ¬ë‹ˆ ìƒí’ˆ ì—…ë°ì´íŠ¸ -> ì„±ê³µ(ì–‘ ë§ì´), ì‹¤íŒ¨(ì ìš© ë¡œìš°ìˆ˜ 0), ì˜ˆì™¸ ë°œìƒ
//        // ìˆ˜ì •_ì„±ê³µ() => ìœ ì € ì¥ë°”êµ¬ë‹ˆ íŠ¹ì • ìƒí’ˆ ì—…ë°ì´íŠ¸
//        // ìˆ˜ì •_ì‹¤íŒ¨_1() => ì—†ëŠ” ìœ ì € ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ì—…ë°ì´íŠ¸, ì ìš© ë¡œìš°ìˆ˜ 0
//        // ìˆ˜ì •_ì‹¤íŒ¨_2() => ìœ ì € ì—†ëŠ” ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ì—…ë°ì´íŠ¸, ì ìš© ë¡œìš°ìˆ˜ 0
//
//    // 1. í•µì‹¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ 2ì°¨ êµ¬í˜„[]
//        // 1-0. ì¹´ìš´íŠ¸ : ìœ ì € ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ê°œìˆ˜ ì¹´ìš´íŠ¸ -> ì„±ê³µ(ì–‘ ë§ì´), ì‹¤íŒ¨(ì ìš© ë¡œìš°ìˆ˜ 0)
//            // ì¹´ìš´íŠ¸_ì„±ê³µ() => íŠ¹ì • ìœ ì € ì•„ì´ë””ë¡œ ìƒí’ˆ ì—¬ëŸ¬ê°œ ë‹´ì•„ì„œ ì¹´ìš´íŠ¸
//            // ì¹´ìš´íŠ¸_ì‹¤íŒ¨() => ì—†ëŠ” ìœ ì € ì•„ì´ë””ë¡œ ì¹´ìš´íŠ¸ í–ˆì„ ë•Œ, ì ìš© ë¡œìš°ìˆ˜ 0
//
//        // 1-1. ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ : ìœ ì € ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ëª©ë¡ ì¡°íšŒ -> ì„±ê³µ(ì–‘ ë§ì´), ì‹¤íŒ¨(ë¦¬ìŠ¤íŠ¸ ê¸¸ì´ 0), ì˜ˆì™¸ ë°œìƒ
//            // ë¦¬ìŠ¤íŠ¸_ì¡°íšŒ_ì„±ê³µ() => íŠ¹ì • ìœ ì € ì•„ì´ë””ë¡œ ìƒí’ˆ ëª©ë¡ ì¡°íšŒ, ê¸¸ì´ ë„£ì€ ìˆ˜ ë§Œí¼
//            // ë¼ìŠ¤íŠ¸_ì¡°íšŒ_ì‹¤íŒ¨() => ì—†ëŠ” ìœ ì € ì•„ì´ë””ë¡œ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ, ê¸¸ì´ 0
//
//        // 1-2. ë“±ë¡ : ìœ ì € ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ë“±ë¡ -> ì„±ê³µ(ì–‘ ë§ì´), ì‹¤íŒ¨(ì ìš© ë¡œìš°ìˆ˜ 0), ì˜ˆì™¸ ë°œìƒ
//            // ë“±ë¡_ì„±ê³µ() => íŠ¹ì • ìœ ì € ì•„ì´ë””ì— ë§ì€ ì–‘ì˜ ìƒí’ˆ ë“±ë¡
//            // ë“±ë¡_ì‹¤íŒ¨_1() => ì—†ëŠ” ìœ ì € ì•„ì´ë””ë¡œ ìƒí’ˆ ë“±ë¡, ì ìš© ë¡œìš°ìˆ˜, ì˜ˆì™¸ ë°œìƒ
//            // ë“±ë¡_ì‹¤íŒ¨_2() => ì•„ì´ë””ê°€ nullë¡œ ìƒí’ˆ ë“±ë¡, ì ìš© ë¡œìš°ìˆ˜, ì˜ˆì™¸ ë°œìƒ
//
//        // 1-3. ë‹¨ê±´ ì‚­ì œ : ìœ ì € ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ì‚­ì œ1(ì‹œí€€ìŠ¤ & ì•„ì´ë””) -> ì„±ê³µ(ì–‘ ë§ì´), ì‹¤íŒ¨(ì ìš© ë¡œìš°ìˆ˜ 0), ì˜ˆì™¸ ë°œìƒ
//            // ë‹¨ê±´_ì‚­ì œ_ì„±ê³µ_1() => ìœ ì € ì•„ì´ë””ì— ë“±ë¡ëœ íŠ¹ì • ìƒí’ˆ ì‚­ì œ
//            // ë‹¨ê±´_ì‚­ì œ_ì‹¤íŒ¨_1_1() => ìœ ì € ì•„ì´ë””ì— ë“±ë¡ë˜ì§€ ì•Šì€ ìƒí’ˆ ì‚­ì œ(ì‹œí€€ìŠ¤ x)
//            // ë‹¨ê±´_ì‚­ì œ_ì‹¤íŒ¨_1_2() => ë“±ë¡ë˜ì§€ ì•Šì€ ìœ ì € ì•„ì´ë””ì— ìƒí’ˆ ì‚­ì œ, ì ìš© ë¡œìš°ìˆ˜ 0
//            // ë‹¨ê±´_ì‚­ì œ_ì‹¤íŒ¨_1_3() => ìœ ì € ì•„ì´ë””ì— ì‚­ì œëœ ë‚´ìš©ì„ ì—¬ëŸ¬ë²ˆ ì‚­ì œ, ì²«ë²ˆì§¸ì—ì„œëŠ” ì ìš© ë¡œìš°ìˆ˜ 1, ê·¸ ì´í›„ì—ëŠ” 0
//
//            // ë‹¨ê±´_ì‚­ì œ_ì„±ê³µ_2() => ë“±ë¡ëœ dtoë¡œ ì‚­ì œí•˜ëŠ” ê²½ìš°, ì ìš© ë¡œìš°ìˆ˜ 1
//            // ë‹¨ê±´_ì‚­ì œ_ì‹¤íŒ¨_2_1() => ë“±ë¡ë˜ì§€ ì•ŠëŠ” dtoë¡œ ì‚­ì œí•˜ëŠ” ê²½ìš°, ì ìš© ë¡œìš°ìˆ˜ 0
//            // ë‹¨ê±´_ì‚­ì œ_ì‹¤íŒ¨_2_2() => ë“±ë¡ë˜ì§€ ì•Šì€ ìœ ì € ì•„ì´ë””ì— dtoë¡œ ìƒí’ˆ ì‚­ì œ, ì ìš© ë¡œìš°ìˆ˜ 0
//            // ë‹¨ê±´_ì‚­ì œ_ì‹¤íŒ¨_2_3() => ìœ ì € ì•„ì´ë””ì— ì‚­ì œëœ ìƒí’ˆì„ ì—¬ëŸ¬ë²ˆ ì‚­ì œ, ì²«ë²ˆì§¸ì—ì„œëŠ” ì ìš© ë¡œìš°ìˆ˜ 1, ê·¸ ì´í›„ì—ëŠ” 0
//
//        // 1-4. ëª¨ë“  ìƒí’ˆ ì‚­ì œ : ìœ ì € ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ëª¨ë‘ ì‚­ì œ -> ì„±ê³µ(ì–‘ ë§ì´), ì‹¤íŒ¨(ì ìš© ë¡œìš°ìˆ˜ 0), ì˜ˆì™¸ ë°œìƒ
//            // ëª¨ë“ _ìƒí’ˆ_ì‚­ì œ_ì„±ê³µ() => ìœ ì € ì•„ì´ë””ì— ë“±ë¡ëœ ìƒí’ˆ ëª¨ë‘ ì‚­ì œ, ì ìš© ë¡œìš°ìˆ˜ n, ì¹´ìš´íŠ¸ 0
//            // ëª¨ë“ _ìƒí’ˆ_ì‚­ì œ_ì‹¤íŒ¨() => ìœ ì € ì•„ì´ë””ì— ë“±ë¡ë˜ì§€ ì•Šì€ ìƒí’ˆ ëª¨ë‘ ì‚­ì œ, ì ìš© ë¡œìš°ìˆ˜ 0
//
//        // 1-5. ìˆ˜ì • : ìœ ì € ì¥ë°”êµ¬êµ¬ë‹ˆ ìƒí’ˆ ì—…ë°ì´íŠ¸ -> ì„±ê³µ(ì–‘ ë§ì´), ì‹¤íŒ¨(ì ìš© ë¡œìš°ìˆ˜ 0), ì˜ˆì™¸ ë°œìƒ
//            // ìˆ˜ì •_ì„±ê³µ() => ìœ ì € ì¥ë°”êµ¬ë‹ˆ íŠ¹ì • ìƒí’ˆ ì—…ë°ì´íŠ¸
//            // ìˆ˜ì •_ì‹¤íŒ¨_1() => ì—†ëŠ” ìœ ì € ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ì—…ë°ì´íŠ¸, ì ìš© ë¡œìš°ìˆ˜ 0
//            // ìˆ˜ì •_ì‹¤íŒ¨_2() => ìœ ì € ì—†ëŠ” ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ì—…ë°ì´íŠ¸, ì ìš© ë¡œìš°ìˆ˜ 0

    @DisplayName(" ì¹´ìš´íŠ¸ ì„±ê³µ - ì‚¬ìš©ìì˜ ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ ê°œìˆ˜ ì¹´ìš´íŠ¸")
    @ParameterizedTest(name="[{index}]. ì‚¬ìš©ìê°€ ë“±ë¡í•œ ìƒí’ˆ ìˆ˜ëŸ‰ -> {0}")
    @ValueSource(ints = {10})
    public void test1(int n) throws Exception {
        insertData(n);
    }

    private void insertData(int amount) throws Exception {
        for (int i=1; i<=10; i++) {
            // ìœ ì €
            UserDto user = new UserDto(""+ i, "password" + i, "name" + i, 999999, 1, "M", 12345678, 1012345678, "test"+i+"@example.com", "user" + i, "user" + i);
            userDao.insertUser(user);

            // ì¥ë°”êµ¬ë‹ˆ
            BasketDto basket = new BasketDto();
            basket.setId(user.getId());
            basketDao.insert(basket);
        }

        for (int i=1; i<=amount; i++) {
            // ìƒí’ˆ
            String num = String.valueOf(i);
            String name = "item" + String.valueOf(i);
            String itemType = "item-type" + String.valueOf(i);
            String custType = "cust-type" + String.valueOf(i);
            int price = i * 10000;
            int discPrice = i * 7000;
            String mainImg = "...";
            int reviewCnt = i * 500;
            double reviewRate = 3.5;
            int likeCnt = i * 50;
            String col = "#1234";
            ItemDto itemDto = new ItemDto(num, name, itemType, custType, price,
                    discPrice, mainImg, reviewCnt, reviewRate, likeCnt, col,
                    null, "manager1", null, "manager1");
            itemDao.insert(itemDto);

            // ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ
            BasketItemDto basketItemDto = new BasketItemDto(0, "1", itemDto.getNum(), itemDto.getName(),
                    5000000, 5, "XL", "COL1", "M", null, null, "Y", null, null, null, null);
            basketItemDao.insert(basketItemDto);

        }


    }


}